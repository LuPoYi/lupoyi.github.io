<!DOCTYPE html>
<html lang='en'><head>
  <title>
    
      Bob 學習筆記
    
  </title>
  <link rel='canonical' href='https://blog.poyi.tw/' />
  <meta charset='utf-8'>
  <meta name='viewport' content='width=device-width, initial-scale=1' />
  <meta name='description' content='' />
  <meta name='theme-color' content='#FD3519' />
  
    <link rel="shortcut icon" href="/favicon.png" type="image/x-icon" />
    <link rel="icon" href="/favicon.png" type="image/x-icon" />
  

  <meta name="generator" content="Hugo 0.58.0" />

  





<link rel="stylesheet" href="https://blog.poyi.tw/sass/style.min.cf2eeff825d4dbc673ce0b82d270d9fc32d34973a7d5cd079e0dcf4fe3e77515.css" integrity="sha256-zy7v&#43;CXU28ZzzguC0nDZ/DLTSXOn1c0Hng3PT&#43;PndRU=" media="screen">
<link rel="stylesheet" href="https://blog.poyi.tw/syntax.min.css" integrity="" media="screen">

  <link rel="stylesheet" href="/stylesheets/custom.css" media="screen">

  <meta property="og:title" content="Bob 學習筆記" />
<meta property="og:description" content="" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://blog.poyi.tw/" />

<meta property="og:updated_time" content="2019-09-15T00:00:00+00:00" />

  <meta itemprop="name" content="Bob 學習筆記">
<meta itemprop="description" content="">


</head>

<body>

  <header style="background-image:linear-gradient(
      rgba(0,0,0,0.4),rgba(0,0,0,0.4)
    ),url(&#39;https://blog.poyi.tw/images/default-sidebar.jpg&#39;)">

  <div class="intro">
    <div class="logo-container">
      <a href="/">
        <img src='https://blog.poyi.tw/images/bob2.jpg' alt="Profile Bob 學習筆記" class="rounded-logo">
      </a>
    </div>
    <h2>Bob</h2>
    <h3>Software Engineer</h3>
    <div class="menu">
      

        <p>
            <a href="/posts/">
                Archive
            </a>
        </p>

        <p>
            <a href="/memo/">
                Memo
            </a>
        </p>

        <p>
            <a href="/about/">
                About
            </a>
        </p>

      
        
        <p>
            <a href="mailto:maydaybob2000@gmail.com" target="_blank" rel="external">
                
            </a>
        </p>
      
    </div>

  </div>

  <div class="socials">
      
  </div>

</header>

  <div class="content-wrapper">
    
      <div class="breadcrumb">
  

<span  class="active">
  <a href="https://blog.poyi.tw/">Bob 學習筆記</a>
  
</span>

</div>

    
    <main id="content" class="">



  <p></p>
  <div id="list">
    
      <a class="h1" href="https://blog.poyi.tw/blog/2013/08/28/aspnet-file-download/">[ASP.NET] 檔案下載寫法</a>
<h2 id="response-writefile-檔案下載方式一">Response.WriteFile 檔案下載方式一</h2>
<div class="highlight"><pre class="chroma"><code class="language-c#" data-lang="c#">    <span class="k">using</span> <span class="nn">System.IO</span><span class="p">;</span>
    
    <span class="kt">string</span> <span class="n">filePath</span> <span class="p">=</span> <span class="s">&#34;C:/porn.jpg&#34;</span><span class="p">;</span>
    <span class="n">FileInfo</span> <span class="n">file</span> <span class="p">=</span> <span class="k">new</span> <span class="n">FileInfo</span><span class="p">(</span><span class="n">filePath</span><span class="p">);</span>
    <span class="n">Response</span><span class="p">.</span><span class="n">Clear</span><span class="p">()</span>
    <span class="n">Response</span><span class="p">.</span><span class="n">Buffer</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span> 
    <span class="n">Response</span><span class="p">.</span><span class="n">ContentType</span> <span class="p">=</span> <span class="s">&#34;application/octet-stream&#34;</span><span class="p">;</span> <span class="c1">// 指定檔案類型
</span><span class="c1"></span> <span class="n">Response</span><span class="p">.</span><span class="n">AddHeader</span><span class="p">(</span><span class="s">&#34;Content-Disposition&#34;</span><span class="p">,</span><span class="s">&#34;attachment;filename=&#34;</span><span class="p">+</span><span class="s">&#34;porn.jpg&#34;</span><span class="p">);</span> <span class="c1">// 設定檔名
</span><span class="c1"></span> <span class="c1">// System.Web.HttpUtility.UrlEncode(newFileName, System.Text.Encoding.UTF8) 解決中文檔名亂碼
</span><span class="c1"></span> <span class="n">Response</span><span class="p">.</span><span class="n">AppendHeader</span><span class="p">(</span><span class="s">&#34;Content-Length&#34;</span><span class="p">,</span> <span class="n">file</span><span class="p">.</span><span class="n">Length</span><span class="p">.</span><span class="n">ToString</span><span class="p">());</span> <span class="c1">// 表頭加入檔案大小
</span><span class="c1"></span> <span class="n">Response</span><span class="p">.</span><span class="n">WriteFile</span><span class="p">(</span><span class="n">file</span><span class="p">.</span><span class="n">FullName</span><span class="p">);</span>
    <span class="n">Response</span><span class="p">.</span><span class="n">Flush</span><span class="p">();</span>
    <span class="n">Response</span><span class="p">.</span><span class="n">End</span><span class="p">();</span>
</code></pre></div>
<h2 id="system-net-webclient-downloaddata-檔案下載方式二">System.Net.WebClient.DownloadData 檔案下載方式二</h2>
<div class="highlight"><pre class="chroma"><code class="language-c#" data-lang="c#">    <span class="k">using</span> <span class="nn">System.Net</span><span class="p">;</span>
     
    <span class="n">WebClient</span> <span class="n">wc</span> <span class="p">=</span> <span class="k">new</span> <span class="n">WebClient</span><span class="p">();</span>
    <span class="kt">byte</span><span class="p">[]</span> <span class="n">byteFile</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>
    <span class="kt">string</span> <span class="n">path</span> <span class="p">=</span> <span class="s">&#34;C:/porn.jpg&#34;</span><span class="p">;</span> <span class="c1">// 設定路徑
</span><span class="c1"></span> <span class="n">byteFile</span> <span class="p">=</span> <span class="n">wc</span><span class="p">.</span><span class="n">DownloadData</span><span class="p">(</span><span class="n">path</span><span class="p">);</span>
    <span class="kt">string</span> <span class="n">fileName</span> <span class="p">=</span> <span class="n">System</span><span class="p">.</span><span class="n">IO</span><span class="p">.</span><span class="n">Path</span><span class="p">.</span><span class="n">GetFileName</span><span class="p">(</span><span class="n">path</span><span class="p">);</span> <span class="c1">// 取得檔案名稱
</span><span class="c1"></span> <span class="n">Response</span><span class="p">.</span><span class="n">AppendHeader</span><span class="p">(</span><span class="s">&#34;content-disposition&#34;</span><span class="p">,</span> <span class="s">&#34;attachment;filename=&#34;</span> <span class="p">+</span> <span class="s">&#34;porn.jpg&#34;</span><span class="p">);</span> <span class="c1">//設定檔名
</span><span class="c1"></span> <span class="c1">// HttpContext.Current.Server.UrlEncode(fileName) 解決中文檔名亂碼
</span><span class="c1"></span> <span class="n">Response</span><span class="p">.</span><span class="n">ContentType</span> <span class="p">=</span> <span class="s">&#34;application/octet-stream&#34;</span><span class="p">;</span>  <span class="c1">// 指定檔案類型    
</span><span class="c1"></span> <span class="n">Response</span><span class="p">.</span><span class="n">BinaryWrite</span><span class="p">(</span><span class="n">byteFile</span><span class="p">);</span> <span class="c1">// 內容轉出作檔案下載
</span><span class="c1"></span> <span class="n">Response</span><span class="p">.</span><span class="n">End</span><span class="p">();</span>
</code></pre></div>
<h2 id="參考資料">參考資料</h2>

<p><a href="http://www.dotblogs.com.tw/jerrymow/archive/2013/04/22/102084.aspx">http://www.dotblogs.com.tw/jerrymow/archive/2013/04/22/102084.aspx</a>
<a href="http://blog.miniasp.com/post/2008/03/12/Caution-about-ASPNET-Response-a-Large-File.aspx">http://blog.miniasp.com/post/2008/03/12/Caution-about-ASPNET-Response-a-Large-File.aspx</a>
<a href="http://www.dotblogs.com.tw/whitewing/archive/2010/03/18/14102.aspx">http://www.dotblogs.com.tw/whitewing/archive/2010/03/18/14102.aspx</a></p>

<br>
    
      <a class="h1" href="https://blog.poyi.tw/blog/2013/08/23/linq-introduction/">[ASP.NET] Linq基本用法</a>
<p>公司前輩跟我提過可以用用看Linq比較潮(?)
寫.NET的時候就不需要寫的這麼..無腦</p>

<pre><code>    sqlStr += &quot;Select ...&quot;;
    sqlStr += &quot;from ....&quot;;
    sqlStr += &quot;join ...&quot;;
    sqlStr += &quot;where ....&quot;
        
    string sql = @&quot;SELECT ...
               FROM table1
               WHERE field3 = @Param1&quot;;
</code></pre>

<p>基本Linq類似這樣</p>

<pre><code>    var Query =
        from q in myDB.Employee
        where q.Name == &quot;Bob&quot;
        select q;
      
Group By
    
    int[] values = {1,2,3,4,5,6};
    var Query =
        from p in values
        group p by p % 2 ==0;
        // values =&gt; 1 3 5 0 2 4
</code></pre>

<br>
    
      <a class="h1" href="https://blog.poyi.tw/blog/2013/08/22/aspnet-viewstatus-session/">[ASP.NET] 頁面傳值</a>
<h2 id="client-base">Client-Base</h2>

<h3 id="viewstate-相當於把值存放於hidden-field當中">ViewState：相當於把值存放於hidden field當中</h3>

<p>只存在單一Web form
預設開啟、未完善加密
不會佔用系統資源
<em>較不適合大量或機密資料</em></p>

<h2 id="server-base">Server-Base</h2>

<h3 id="session-類似跨網頁的全域變數">Session：類似跨網頁的全域變數</h3>

<p>多個頁面傳值
預設存放記憶體
可設定Time out</p>

<br>
    
      <a class="h1" href="https://blog.poyi.tw/blog/2013/07/28/sql-syntax/">[SQL] 常用語法</a>
<p><h3 id="不一定是常用-而是記不太起來-每次都要查">不一定是常用…而是記不太起來，每次都要查…</h3>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="n">DBCC</span> <span class="n">CHECKIDENT</span> <span class="p">(</span> <span class="o"><em></span><span class="n">tablename</span><span class="o"></em></span><span class="p">,</span> <span class="n">RESEED</span><span class="p">,</span> <span class="n">new_reseed_value</span> <span class="p">)</span> <span class="err">強制重設</span><span class="n">table的識別值</span></p>

<p><span class="n">DBCC</span> <span class="n">CHECKIDENT</span><span class="p">(</span><span class="n">tablename</span><span class="p">,</span>  <span class="n">RESEED</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="o">//</span> <span class="err">歸零識別值</span></code></pre></div>
<p>SQL驗證
Data Source=<strong><em>;Initial catalog=</em></strong>;User ID=<strong><em>;Password=</em></strong></p></p>

<p>Windows驗證
Data Source=<strong><em>;Initial Catalog=</em></strong>;integrated security=sspi</p>

<p>union:上下重直合併</p>

<p>萬用字元</p>

<pre><code>%
_:代表一個字元
〔〕:指定字元範圍；[0-9]、[A-D]、[ABCD]
〔^〕:排除字元範圍:[^ABC]
</code></pre>

<br>
    
      <a class="h1" href="https://blog.poyi.tw/blog/2013/07/22/common-e-mail-errors/">[English] Common E-mail Errors</a>
<h2 id="台灣人常出現的email-issue">台灣人常出現的Email issue</h2>

<p>X : We need to cost down on this project. (&ldquo;cost down&rdquo; is not a word)<br>
X : Please feel free to contact with me. (&ldquo;with&rdquo; is unnecessary)<br>
X : If you have any question, please let me know. (&ldquo;questions&rdquo;)</p>

<p>&ndash;</p>

<p>Subject Lines:</p>

<p>Subject Lines aren&rsquo;t sentences, so don&rsquo;t use period(.)</p>

<p>Greeting:</p>

<p>X: Dear Miss Lu, (Ms. is correct, because we don&rsquo;t know she is married or not)<br>
X: Dear Client,<br>
X: Dear both,<br>
X: Dear CEO Bob Lu, (Don&rsquo;t use title)<br>
X: Dear Boss Huang,<br>
X: Dears,<br></p>

<p>The Body:</p>

<p>These are usually separated by paragraphs<br>
Don&rsquo;t overusing exclamation mark(!)</p>

<p>Closings:</p>

<p>X: Best Regards, (&ldquo;regards&rdquo; is correct)<br>
X: See you~~~<br>
X: Tks,<br></p>

<br>
    
      <a class="h1" href="https://blog.poyi.tw/blog/2013/07/22/string-syntax/">[C#] String常用語法</a>
<p>StringBuilder: 用append串接；大量動態字串時效率較高
String: 用+串接；固定字串時，效率較高</p>

<h2 id="一般情況都用string">一般情況都用String</h2>

<p><strong>String.IndexOf</strong>
找字串中第一次出現的index</p>

<pre><code>if(employeeName.IndexOf(&quot;Admin&quot;) == -1)    // 可判斷Name中是否有符合Admin的字串
</code></pre>

<p><strong>String.LastIndexOf</strong>
找字串中最後一次出現的index</p>

<p><strong>Substring(int startIndex, int length)</strong> 擷取字串</p>

<pre><code>string str = &quot;台灣駐史瓦濟蘭大使館&quot;;
str.Substring(3, 6);    // output: 史瓦濟蘭大使
</code></pre>

<p><strong>Split</strong> 分隔字串</p>

<pre><code>string wholeString = &quot;Bob.Lu&quot;;
string[] spiltString = wholeString.Split(new string[] { &quot;.&quot; }, StringSplitOptions.RemoveEmptyEntries);
aryUserInfo[0].ToString(); // output: Bob
</code></pre>

<p><strong>Regex.IsMatch(string input,   string pattern)</strong> 是否包含xxx</p>

<pre><code>Regex.IsMatch(strPwd, &quot;[0-9]&quot;)  // = Regex.IsMatch(strPwd, @&quot;\d&quot;)

Regex.IsMatch(strPwd, @&quot;[\W]&quot;)
</code></pre>

<p>pattern表示法 :
\d : [0-9] 數字
\D : 數字以外的字元
\w : [a-zA-Z0-9_]
\W : \w以外的字元</p>

<br>
    
      <a class="h1" href="https://blog.poyi.tw/blog/2013/03/03/aspnet-auto-return/">[C#] 自動寄信</a>
<p><p>一樣是紀綠一下&hellip;</p>
<div class="highlight"><pre class="chroma"><code class="language-c#" data-lang="c#"><span class="n">MailMessage</span> <span class="n">mailMessage</span> <span class="p">=</span> <span class="k">new</span> <span class="n">MailMessage</span><span class="p">();</span>
<span class="n">mailMessage</span><span class="p">.</span><span class="n">IsBodyHtml</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span></p>

<p><span class="n">mailMessage</span><span class="p">.</span><span class="n">To</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">emailAddress</span><span class="p">);</span>
<span class="n">mailMessage</span><span class="p">.</span><span class="n">CC</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">cCMailAddress</span><span class="p">);</span></p>

<p><span class="n">MailAddress</span> <span class="n">fromWho</span> <span class="p">=</span> <span class="k">new</span> <span class="n">MailAddress</span><span class="p">(</span><span class="n">senderMailAddress</span><span class="p">);</span>
<span class="n">mailMessage</span><span class="p">.</span><span class="n">From</span> <span class="p">=</span> <span class="n">fromWho</span><span class="p">;</span>
<span class="n">mailMessage</span><span class="p">.</span><span class="n">Subject</span> <span class="p">=</span> <span class="n">title</span><span class="p">;</span>
<span class="n">mailMessage</span><span class="p">.</span><span class="n">Body</span> <span class="p">=</span> <span class="s">&#34;這邊可放html&#34;</span></p>

<p><span class="n">SmtpClient</span> <span class="n">mailSmtp</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SmtpClient</span><span class="p">(</span><span class="n">mailServer</span><span class="p">,</span><span class="n">mailServerPort</span><span class="p">);</span></p>

<p><span class="n">mailSmtp</span><span class="p">.</span><span class="n">Send</span><span class="p">(</span><span class="n">mailMessage</span><span class="p">);</span>
</code></pre></div></p>

<br>
    
      <a class="h1" href="https://blog.poyi.tw/blog/2013/03/03/c-datatable-operation-memos/">[C#] DataTable 的操作備忘</a>
<p><p>稍微記一下，相關變化都蠻簡單的</p>
<div class="highlight"><pre class="chroma"><code class="language-c#" data-lang="c#"><span class="n">DataTable</span> <span class="n">dt</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DataTable</span><span class="p">();</span></p>

<p><span class="c1">// 定義欄位
</span><span class="c1"></span><span class="n">dt</span><span class="p">.</span><span class="n">Columns</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="s">&#34;name&#34;</span><span class="p">);</span>
<span class="n">dt</span><span class="p">.</span><span class="n">Columns</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="s">&#34;cardNumber&#34;</span><span class="p">);</span>
<span class="c1">// 也可定義欄位型態
</span><span class="c1">// dt.Columns.Add(&#34;ID&#34;, typeof(Int32));
</span><span class="c1"></span>
<span class="n">dt</span><span class="p">.</span><span class="n">Rows</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="s">&#34;Bob&#34;</span><span class="p">,</span> <span class="s">&#34;12345&#34;</span><span class="p">);</span>
<span class="n">dt</span><span class="p">.</span><span class="n">Rows</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="s">&#34;Ada&#34;</span><span class="p">,</span> <span class="s">&#34;10000&#34;</span><span class="p">);</span>
<span class="n">dt</span><span class="p">.</span><span class="n">Rows</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="s">&#34;Kilin&#34;</span><span class="p">,</span><span class="s">&#34;20000&#34;</span><span class="p">);</span>
<span class="c1">// 也可用DataRow來存放資料
</span><span class="c1"></span></p>

<p><span class="c1">// 格式相同直接放入GridView
</span><span class="c1"></span><span class="n">GridView</span><span class="p">.</span><span class="n">DataSource</span> <span class="p">=</span> <span class="n">dt</span><span class="p">;</span>
<span class="n">GridView</span><span class="p">.</span><span class="n">DataBind</span><span class="p">();</span>
</code></pre></div></p>

<br>
    
      <a class="h1" href="https://blog.poyi.tw/blog/2013/02/15/linux-getting-started-with-hyper-basic-instructions/">[Linux] 超入門的基本指令</a>
<p>之前在非洲服役時，曾想過用Linux取代Windows (當地經濟因素等等的&hellip;)
也嘗試用Wine來執行一些常用的Windows軟體，大致上也都沒問題，只可惜當地政府的課程始終沒有開始&hellip;</p>

<p>對Linux不是完全陌生，但指令倒是全忘了&hellip;
為了往後開發上不會綁手綁腳，還是必須把基本功打好，從零開始</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1"># 系統資訊</span>
$ <span class="nb">echo</span> hello word
$ date
$ arch  // x86_64
$ uname –a // list system
$ who
$ w // show online user
$ top // show system status
$ cal <span class="m">2015</span> // calendar
$ cal <span class="m">9</span> <span class="m">1752</span> // *
$ bc –l // calculator
$ <span class="nb">echo</span> <span class="m">77</span>/50 <span class="p">|</span> bc –l
$ <span class="nb">history</span> // list <span class="nb">command</span> history</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1"># 網路</span>
$ ifconfig
$ nslookup
$ ping
$ traceroute
$ wget // download
$ ssh 帳號@主機 // 用SSH連線</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1"># chmod 調整檔案權限</span>

chmod <span class="o">[</span>權限角色<span class="o">]</span> <span class="o">[</span>權限動作<span class="o">]</span> <span class="o">[</span>存取權限<span class="o">]</span> 檔案/目錄
chmod <span class="o">[</span>ugoa<span class="o">]</span> <span class="o">[</span>+-<span class="o">=]</span> <span class="o">[</span>rwxX<span class="o">]</span> test.txt
$ chmod ugo+r test.txt 
權限角色: u<span class="o">(</span>user/owner<span class="o">)</span>、g<span class="o">(</span>group<span class="o">)</span>、o<span class="o">(</span>other<span class="o">)</span>、a<span class="o">(</span>all<span class="o">)</span>
權限動作: +<span class="o">(</span>增加權限<span class="o">)</span>、-<span class="o">(</span>取消權限<span class="o">)</span>、<span class="o">=(</span>直接設定權限<span class="o">)</span>
存取權限: r<span class="o">(</span><span class="nb">read</span><span class="o">)</span>、w<span class="o">(</span>write<span class="o">)</span>、x<span class="o">(</span>execute<span class="o">)</span>、X<span class="o">(</span>execute<span class="p">&amp;</span>目錄or已被執行過<span class="o">)</span>

也可用數字來調整權限
chmod <span class="o">[</span>u<span class="o">(</span>int<span class="o">)][</span>g<span class="o">(</span>int<span class="o">)][</span>o<span class="o">(</span>int<span class="o">)]</span> 檔案/目錄
$ chmod <span class="m">777</span> test.txt
<span class="nv">r</span><span class="o">=</span><span class="m">4</span>，w<span class="o">=</span><span class="m">2</span>，x<span class="o">=</span><span class="m">1</span> 
-rwx-r--r--<span class="o">(</span>10個參數，第一個無關chmod<span class="o">)</span>
<span class="m">2</span>~4: user, <span class="m">5</span>~7: group, <span class="m">8</span>~10: others
755代表 rwxr-xr-x</code></pre></div>
<p>Reference:</p>

<p><a href="http://www.pcnet.idv.tw/pcnet/linux/linux_command.htm">http://www.pcnet.idv.tw/pcnet/linux/linux_command.htm</a></p>

<p><a href="http://tnrc.ncku.edu.tw/course/93/fedora_core2/page8/p8.htm">http://tnrc.ncku.edu.tw/course/93/fedora_core2/page8/p8.htm</a></p>

<p><a href="http://jdev.tw/blog/3599/linux-terminal-commands-and-shortcuts">http://jdev.tw/blog/3599/linux-terminal-commands-and-shortcuts</a></p>

<br>
    
      <a class="h1" href="https://blog.poyi.tw/blog/2013/02/14/aspnet-reset-password-in-active-directory/">[ASP.NET] Reset Password in Active Directory</a>
<p><p>重設密碼建議還是用LDAP去抓USER，以免抓錯人之類的</p>
<div class="highlight"><pre class="chroma"><code class="language-C#" data-lang="C#"><span class="c1">// Reset Password in Active Directory
</span><span class="c1"></span><span class="n">DirectoryEntry</span> <span class="n">userDirEntry</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DirectoryEntry</span><span class="p">(</span><span class="s">&#34;LDAP://&#34;</span> <span class="p">+</span> <span class="n">ldapStr</span><span class="p">,</span> <span class="n">adminAccount</span><span class="p">,</span> <span class="n">adminPassword</span><span class="p">);</span>
<span class="n">userDirEntry</span><span class="p">.</span><span class="n">Invoke</span><span class="p">(</span><span class="s">&#34;SetPassword&#34;</span><span class="p">,</span> <span class="n">CreateRandomPassword</span><span class="p">(</span><span class="m">8</span><span class="p">));</span>  <span class="c1">// 重設新密碼
</span><span class="c1"></span><span class="n">userDirEntry</span><span class="p">.</span><span class="n">CommitChanges</span><span class="p">();</span></p>

<p><span class="n">userDirEntry</span><span class="p">.</span><span class="n">Properties</span><span class="p">[</span><span class="s">&#34;pwdLastSet&#34;</span><span class="p">].</span><span class="n">Value</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="c1">// 下次登入會強制要求改密碼
</span><span class="c1"></span><span class="n">userDirEntry</span><span class="p">.</span><span class="n">CommitChanges</span><span class="p">();</span></p>

<p><span class="n">userDirEntry</span><span class="p">.</span><span class="n">Close</span><span class="p">();</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-C#" data-lang="C#"><span class="c1">// Generate Random Password (Winform)
</span><span class="c1"></span>
<span class="k">public</span> <span class="k">static</span> <span class="kt">string</span> <span class="n">CreateRandomPassword</span><span class="p">(</span><span class="kt">int</span> <span class="n">passwordLength</span><span class="p">)</span>
<span class="p">{</span>
      <span class="kt">string</span> <span class="n">allowedChars</span> <span class="p">=</span> <span class="s">&#34;abcdefghijkmnprstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ23456789~!@#$%^&amp;*()_+?&#34;</span><span class="p">;</span>
      <span class="kt">char</span><span class="p">[]</span> <span class="n">chars</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">char</span><span class="p">[</span><span class="n">passwordLength</span><span class="p">];</span>
      <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">passwordLength</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
      <span class="p">{</span>
            <span class="n">chars</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">=</span> <span class="n">allowedChars</span><span class="p">[</span><span class="n">rd</span><span class="p">.</span><span class="n">Next</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="n">allowedChars</span><span class="p">.</span><span class="n">Length</span><span class="p">)];</span><br />
            <span class="c1">// random.next(min,max) =&gt;int
</span><span class="c1"></span>      <span class="p">}</span>
      <span class="kt">string</span> <span class="n">strPwd</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">string</span><span class="p">(</span><span class="n">chars</span><span class="p">);</span></p>

<pre><code>  &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(!((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Regex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;IsMatch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;strPwd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#34;[0-9]&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; 
  &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Regex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;IsMatch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;strPwd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#34;[a-z]&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; 
  &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Regex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;IsMatch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;strPwd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#34;[A-Z]&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; 
  &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Regex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;IsMatch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;strPwd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;@&amp;#34;[\W]&amp;#34;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))))&lt;/span&gt;    
  &lt;span class=&quot;c1&quot;&gt;// \w  [a-zA-Z0-9_]  , \W ![a-zA-Z0-9_]
</code></pre>

<p></span><span class="c1"></span>      <span class="p">{</span>
            <span class="n">strPwd</span> <span class="p">=</span> <span class="n">CreateRandomPassword</span><span class="p">(</span><span class="m">8</span><span class="p">);</span><br />
      <span class="p">}</span></p>

<pre><code>  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;strPwd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
</code></pre>

<p><span class="p">}</span></p>

<p><span class="c1">// 靜態避免短時期內產生相同亂數
</span><span class="c1"></span><span class="k">static</span> <span class="n">Random</span> <span class="n">rd</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Random</span><span class="p">(</span><span class="n">GetRandomSeed</span><span class="p">());</span>
<span class="k">static</span> <span class="kt">int</span> <span class="n">GetRandomSeed</span><span class="p">()</span>
<span class="p">{</span>
      <span class="kt">byte</span><span class="p">[]</span> <span class="n">bytes</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="p">[</span><span class="m">4</span><span class="p">];</span>
      <span class="n">System</span><span class="p">.</span><span class="n">Security</span><span class="p">.</span><span class="n">Cryptography</span><span class="p">.</span><span class="n">RNGCryptoServiceProvider</span> <span class="n">rng</span> <span class="p">=</span>
      <span class="k">new</span> <span class="n">System</span><span class="p">.</span><span class="n">Security</span><span class="p">.</span><span class="n">Cryptography</span><span class="p">.</span><span class="n">RNGCryptoServiceProvider</span><span class="p">();</span>
      <span class="n">rng</span><span class="p">.</span><span class="n">GetBytes</span><span class="p">(</span><span class="n">bytes</span><span class="p">);</span>
      <span class="k">return</span> <span class="n">BitConverter</span><span class="p">.</span><span class="n">ToInt32</span><span class="p">(</span><span class="n">bytes</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></p>

<br>
    
  </div>

  <div class="pagination">
    
      <a class="prev" href="/page/8/">&larr; Older</a>
    
  
    
      <a class="next" href="/page/6/">Newer &rarr;</a>
    
  </div>

    </main>
  </div>
  <footer>
    <div class="footer-wrapper">
      <p>Made with ❤️ &mdash; Powered by <a href="https://gohugo.io/" target="_blank" rel="external">Hugo</a> and the <a href="https://github.com/bjacquemet/personal-web" target='_blank' rel="external">Personal Web</a> theme.</p>
      <p></p>
    </div>
  </footer>
  <link href="https://fonts.googleapis.com/css?family=Montserrat:500,600|Raleway:400,400i,600" rel="stylesheet">
  
</body>
</html>

